<!DOCTYPE html>
<html >
<head>
	<title>Yet Another Clicker Game</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
	<link rel="stylesheet" href="theme.css"/>
 	<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
	<script src="utilities.js"></script>
	<script src="journalUtilities.js"></script>
	<script src="building.js"></script>
	<script src="game.js"></script>
	<script src="monster.js"></script>
</head>
<body ng-app='HeroicAdventure'>
	<div ng-controller="CharacterCtrl as character" class='container'>
		<div id='menu'>
			<a href data-toggle="tooltip" data-placement="bottom" data-original-title="Save your game." ng-click="character.save()">Save</a>
			<a href data-toggle="tooltip" data-placement="bottom" data-original-title="Load your game." ng-click="character.load()">Load</a>
			<a href data-toggle="tooltip" data-placement="bottom" data-original-title="Reset your game." ng-click="character.reset()">Reset</a>
		</div>
		<div id='stats'>
			<span>Name:</span> <input ng-model="character.hero.name" type="text" ng-disabled="character.hero.nameLocked"/> <br />
            <small><small>Do not exceed 20 letters, please.</small></small><br /><br />
			<span>Level:</span> {{character.hero.level}}<br />
			<span>Experience:</span> {{character.hero.experiencePoints}}<br />
			<br><span>Power:</span>	{{character.hero.power}}
			<br><span>Health:</span><span ng-class="{low:(character.hero.currentHealth/character.hero.maxHealth) < 0.25}"> {{character.hero.currentHealth|number:2}}/{{character.hero.maxHealth|number:2}}</span> (+{{character.hero.regen.health}} / sec)
			<br><span>Stamina:</span>	<span ng-class="{low:(character.hero.currentStamina/character.hero.maxStamina) < 0.25}"> {{character.hero.currentStamina|number:2}}/{{character.hero.maxStamina|number:2}}</span> (+{{character.hero.regen.stamina}} / sec)
			<div><span>Day:</span> {{character.day}}</div>
            <br>Inventory:
            <span ng-repeat="item in character.hero.itemInventory" ng-show="item.itemNumber > 0"><br>{{item.itemName}}: {{item.itemNumber|number:2}}</span>
            
            
		</div>
		
        
        <div id="gameSection" ng-controller="ViewCtrl as view" style="width: 80%;">
            
        	<ul class="nav nav-tabs">
        		<li role="presentation" ng-repeat="menuItem in view.menu" ng-class="{active:view.activeView == menuItem}"><a href ng-click="view.switchActiveView(menuItem)">{{menuItem}}</a></li>
        	</ul>
            
            
            <!-- Battle Section -->
            <div class="panel" id="divAction" ng-controller="ActionCtrl as action" ng-show="view.activeView == 'Battle'">
                <div ng-controller="MonsterData as monster">

                    Choose your attack type:
                    <div ng-repeat="attack in character.hero.attackType">
                        <input type="radio" title="{{attack.flavText}}" ng-model="character.hero.selectedAttackID" ng-change="character.hero.selectAttack()" ng-value="attack.attackID"><b><span title="{{attack.flavText}}" ng-class="{attackIsSelected:character.hero.selectedAttackID === attack.attackID}"><span ng-class="attack.damageType">{{attack.attackName}}</span></b>: Cost {{attack.staminaUsage}} stamina. Deals <span ng-class="attack.damageType">{{attack.damageType}}</span> damage.</span>
                    </div><br>

                    <div ng-repeat="mons in monster.monstah">
                        <button class='monster btn btn-default' ng-disabled="character.hero.unconscious" ng-click="action.battle(character.hero, mons)" ng-show="mons.levelReq<=character.hero.level">Fight {{mons.name}} [HP: {{mons.currentHealth|number:2}}/{{mons.maxHealth|number:2}}]</button>
                    </div>

                </div>
            </div>

            <!-- Building Section -->
            <div class="panel" id="divBuilding" ng-controller="BuildingCtrl as building" ng-show="view.activeView == 'Building'">
                <div id="playerOwnedSection">
                    Number of miner: {{building.miningTown.activeMiners}}/{{building.miningTown.totalMiners}}
                    Number of mines owned:
                    <ul ng-repeat="miningPlace in building.miningTown.miningPlace">
                        <li>{{miningPlace.name}}: {{miningPlace.numOwned}}. Number of miners working here: {{miningPlace.numMiner}}</li>
                    </ul>
                </div>
                <div id="buySection">
                    <table>
                        <tr id="buyMiners">
                            <td><button ng-click="building.miningTown.buyMiners()">Buy Miners. Cost: {{building.calculatePrice(building.miningTown.baseMinersPrice, building.miningTown.baseMinersPriceRatio, building.miningTown.totalMiners)|number:2}}</button></td>
                            <td><button ng-click="building.miningTown.sellMiners()">Sell Miners.</button></td>
                        </tr>
                        <tr id="buyMiningSpots" ng-repeat="miningPlace in building.miningTown.miningPlace">
                            <td><button ng-click="building.miningTown.buyMine(miningPlace.name)">Buy {{miningPlace.name}}. Cost: {{building.calculatePrice(miningPlace.basePrice, miningPlace.priceRatio, miningPlace.numOwned)|number:2}}</button></td>
                            <td><button ng-click="building.miningTown.addMiners(miningPlace.name)">Allocate Miner here</button></td>
                            <td><button ng-click="building.miningTown.removeMiners(miningPlace.name)">Remove Miner from here</button></td>
                        </tr>
                    </table>
                </div><br>
            </div>

            <!-- Item Shop Section -->
            <div class="panel" id="divItemShop" ng-show="view.activeView == 'Item Shop'">
                Item Shop SECTION!
            </div>

            <!-- Armory Section -->
            <div class="panel" id="divArmory" ng-show="view.activeView == 'Armory'">
                Armory SECTION!
            </div>

            <!-- Explore Section -->
            <div class="panel" id="divExplore" ng-show="view.activeView == 'Explore'">
                Explore SECTION!
            </div>

            <!-- Change Equipment Section -->
            <div class="panel" id="divChangeEquipment" ng-show="view.activeView == 'Equipment'">
                Change Equipment SECTION!
            </div>
            
        </div>
        
	</div>
    
    <div class="container" id="journal" width="70vw">
        <h3>Journal Log:</h3>
        <div id="divJournal" ></div>
    </div>
    
</body>
</html>